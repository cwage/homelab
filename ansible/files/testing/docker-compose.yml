# Resume preview container for testing branches before merging
# Deployed by: make ansible-testing-deploy
# Managed by Ansible - do not edit manually on the host
services:
  resume-testing:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: resume-testing
    restart: unless-stopped
    env_file:
      - .env
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.preview.rule=Host(`preview.lan.quietlife.net`)"
      - "traefik.http.routers.preview.entrypoints=websecure"
      - "traefik.http.routers.preview.tls=true"
      - "traefik.http.services.preview.loadbalancer.server.port=4000"
    volumes:
      - resume_testing_site:/site
      - ./deploy_key:/run/secrets/deploy_key:ro
    networks:
      - proxy

volumes:
  resume_testing_site:

networks:
  proxy:
    external: true
